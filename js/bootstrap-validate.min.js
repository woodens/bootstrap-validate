(function(d,c,b,e){d.fn.SimValidate=function(f){var g=new a(this,f);simObject=g;return g};var a=function(f,g){if(f==null||f==e){alert("没有设定校验元素!");return}this.$eles=f;this.eles_path=this.getPath(f);this.defaults={shortTest:true,autoTest:true};this.settings=d.extend({},this.defaults,g);f.find("[message-for]").addClass("sr-only");f.find("[message-for]").parents(".form-group").removeClass("has-error");if(this.settings.autoTest){this.autoValidate()}};a.prototype={autoValidate:function(){var f=this.validators;var j=this.$eles;var g=this.eles_path;var h=this.settings;var i=this;j.find("[test-id]").each(function(m){var l=d(this).attr("test-id");var k=d(this);if(k.find("[test-point]").size()==0){d(g).on("focus","[test-id='"+l+"']",function(){j.find("[message-for='"+l+"']").addClass("sr-only");j.find("[message-for='"+l+"']").parents(".form-group").removeClass("has-error")});d(g).on("keyup","[test-id='"+l+"']",function(){i.testElement(k,l)});d(g).on("blur","[test-id='"+l+"']",function(){i.testElement(k,l)});d(g).on("change","[test-id='"+l+"']",function(){i.testElement(k,l)})}else{d(g).on("focus","[test-id='"+l+"'] [test-point]",function(){j.find("[message-for='"+l+"']").addClass("sr-only");j.find("[message-for='"+l+"']").parents(".form-group").removeClass("has-error")});d(g).on("keyup","[test-id='"+l+"'] [test-point]",function(){j.find("[message-for='"+l+"']").addClass("sr-only");j.find("[message-for='"+l+"']").parents(".form-group").removeClass("has-error");i.testElement(k)});d(g).on("blur","[test-id='"+l+"'] [test-point]",function(){j.find("[message-for='"+l+"']").addClass("sr-only");j.find("[message-for='"+l+"']").parents(".form-group").removeClass("has-error");i.testElement(k)});d(g).on("change","[test-id='"+l+"'] [test-point]",function(){j.find("[message-for='"+l+"']").addClass("sr-only");j.find("[message-for='"+l+"']").parents(".form-group").removeClass("has-error");i.testElement(k)});d(g).on("click","[test-id='"+l+"'] [test-point]",function(){j.find("[message-for='"+l+"']").addClass("sr-only");j.find("[message-for='"+l+"']").parents(".form-group").removeClass("has-error");i.testElement(k,l)})}})},validate:function(){this.$eles.find("[message-for]").addClass("sr-only");this.$eles.find("[message-for]").parents(".form-group").removeClass("has-error");var f=true;var g=this;this.$eles.find("[test-id]").each(function(h){f&=g.testElement(d(this))});return f},testElement:function(k){var i=this.validators;var n=this.$eles;var h=this.settings;var l=true;for(var o in i){if(h.shortTest&&!l){break}var g=k.attr(o);if(g==null){continue}var f=i[o];var m=k.val();var j=k.attr("test-id");if(k.data("depend")&&!n.find('[test-depend="'+k.data("depend")+'"]').is(":checked")){continue}if(!f(m,g,k,this)){if(n.find("[message-for='"+j+"']").size()>1){n.find("[message-for='"+j+"'][test-type='"+o+"']").removeClass("sr-only");n.find("[message-for='"+j+"'][test-type='"+o+"']").parents(".form-group").addClass("has-error")}else{n.find("[message-for='"+j+"']").removeClass("sr-only");n.find("[message-for='"+j+"']").parents(".form-group").addClass("has-error")}l=false}else{if(n.find("[message-for='"+j+"']").size()>1){n.find("[message-for='"+j+"'][test-type='"+o+"']").addClass("sr-only");n.find("[message-for='"+j+"'][test-type='"+o+"']").parents(".form-group").removeClass("has-error")}else{n.find("[message-for='"+j+"']").addClass("sr-only");n.find("[message-for='"+j+"']").parents(".form-group").removeClass("has-error")}}}return l},extend:function(f){d.extend(this.validators,f)},getPath:function(f){if(f.length!=1){throw"Requires one element."}var k,j=f;while(j.length){var i=j[0],g=i.localName;if(!g){break}g=g.toLowerCase();var h=j.parent();var l=h.children(g);if(l.length>1){g+=":eq("+l.index(i)+")"}k=g+(k?">"+k:"");j=h}return k}};a.prototype.validators={distinct:function(h,k,f,j){if(h==null||h.length==0){return true}var g=f.attr("test-id");var i=false;d("[distinct='"+k+"']").each(function(){if(g!=d(this).attr("test-id")&&h==d(this).val()){i=true}});return !i},equalTo:function(h,j,f,i){if(h==null||h.length==0){return true}if(i.settings.autoTest){var g=f.attr("test-id");d(i.eles_path).on("blur","[test-id='"+j+"']",function(){i.$eles.find("[message-for='"+g+"']").addClass("sr-only");i.$eles.find("[message-for='"+g+"']").parents(".form-group").removeClass("has-error");i.testElement(f)})}if(i.$eles.find("[test-id='"+j+"']").val()==h){return true}else{return false}},required:function(f){if(f==null||f.length==0){return false}else{return true}},number:function(f){if(f==null||f.length==0){return true}if(f.length>0&&d.trim(f).length==0){return false}return !isNaN(f)},groupRequired:function(g,i,h){var f=false;h.find("[test-point]").each(function(){if(d(this).is(":checked")){f=true}});return f},max:function(g,f){if(g==null||g.length==0){return true}if(parseFloat(g)>parseFloat(f)){return false}else{return true}},min:function(g,f){if(g==null||g.length==0){return true}if(parseFloat(g)<parseFloat(f)){return false}else{return true}},minlength:function(g,f){if(g==null||g.length==0){return true}if(g.length<parseFloat(f)){return false}else{return true}},email:function(g){if(g==null||g.length==0){return true}var f=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;if(f.test(g)){return true}else{return false}},mobile:function(g){if(g==null||g.length==0){return true}var f=/^((\+?86)|(\(\+86\)))?(13[012356789][0-9]{8}|15[012356789][0-9]{8}|17[012356789][0-9]{8}|18[02356789][0-9]{8}|147[0-9]{8}|1349[0-9]{7})$/;if(f.test(g)){return true}else{return false}},idcard:function(f){if(f==null||f.length==0){return true}var n=/^(^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$)|(^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])((\d{4})|\d{3}[Xx])$)$/;if(n.test(f)){if(f.length==18){var k=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2);var j=new Array(1,0,10,9,8,7,6,5,4,3,2);var m=0;for(var g=0;g<17;g++){m+=f.substring(g,g+1)*k[g]}var h=m%11;var l=f.substring(17);if(h==2){if(l=="X"||l=="x"){return true}else{return false}}else{if(l==j[h]){return true}else{return false}}}}else{return false}}}})(jQuery,window,document);